<div id="groups"></div>
<style>
  body{
    background:#c4c4c4;
    overflow:hidden;
  }
  ::-webkit-scrollbar {
    width: 10px;
  }
  
  ::-webkit-scrollbar-track {
  }
   
  ::-webkit-scrollbar-thumb {
    background: black; 
    border-radius: 10px;
  }
  
  ::-webkit-scrollbar-thumb:hover {
    background: gray; 
  }
  #groups{
    width:100%;
    height:90%;
    position:absolute;
    left:0px;
    bottom:0px;
    overflow-y:scroll;
    overflow-x:hidden;
  }
  .grouptext{
    position: relative;
    left: 5px;
    align-self: flex-start;
    display: flex;
  }
  .groupbox{
    display: flex;
    border-top: 3px solid black;
    border-bottom: 3px solid black;
    width: 100%;
    padding-top: 5px;
    padding-bottom: 5px;
    flex-direction: row;
    justify-content: space-between;
  }
  .groupbutton{
    position: relative;
    right: 5px;
    display: flex;
    background: black;
    color:#c4c4c4;
    border: 0px;
    border-radius: 27px;
    float: right;
    align-self: flex-end;
  }
</style>
<script>
  var clientuser=localStorage.getItem("username");
  var clientpassword=localStorage.getItem("password");

  if (clientuser==undefined || clientuser==null){
    window.location.href="/signup";
  }
  
  function getText(file){
    return new Promise((resolve) => {
      fetch(file)
        .then((response) => {
          return response.text();
        })
        .then((txt) => {
          resolve(txt);
        });
    });
  }
  function join(element){
    var passwordinuse=prompt("Password?");
    var verify=await getText("https://server-dragon731012.koyeb.app/?val=v&group="+groupinuse+"&password="+passwordinuse);
    if (verify=="Valid"){
      window.location.href="/?group="+element.dataset.group+"&password="+passwordinuse;
    } else {
      alert("Incorrect password!");
    }
  }
  async function start(){
    groups=await getText("https://server-dragon731012.koyeb.app/group.php?val=r");
    var grouplines=groups.toString().split("|");
    var groupjson={groups: []};
    for(var i=0;i<grouplines.length-1;i++){
      var tempjson={};
      tempjson.name=grouplines[i];
      groupjson.groups.push(tempjson);
    }
    
    for (var i=0;i<groupjson.groups.length;i++){
      var groupdiv=document.createElement("div");
      groupdiv.className="groupbox";

        groupdiv.innerHTML="<div class='grouptext'><b>"+groupjson.groups[i].name+"</b></div><button class='groupbutton' data-group='"+groupjson.groups[i].name+"' onclick='join(this);'>Join</button>";
      document.getElementById("groups").appendChild(groupdiv);
    }
  }
  start();
</script>
